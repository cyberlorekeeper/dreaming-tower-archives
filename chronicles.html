<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cyber Lorekeeper — Chronicles</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <meta name="description" content="Recovered chronicles from the Dreaming Tower archives. Read tales from the Digital Realm and flip to real-world analysis." />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'deep-space':'#0A141B',
            'abyss':'#0F2230',
            'rift':'#143545',
            'nebula':'#1E6175',
            'glow':'#35C6E0',
            'stardust':'#CFE5EF',
            indigo:'#4B5DFF', violet:'#7C4DFF', ember:'#F0B429',
            fog:'#E9EDF2', silver:'#C9D1D9', parchment:'#F7F4EF', aether:'#0B0F14', runic:'#1A2430'
          },
          fontFamily:{ display:['Cinzel','serif'], body:['Source Sans 3','ui-sans-serif','system-ui'] },
          boxShadow:{
            glow:'0 0 0 2px rgba(53,198,224,.15), 0 10px 28px rgba(0,0,0,.25)',
            card:'0 6px 18px rgba(0,0,0,.12)'
          }
        }
      }
    }
  </script>

  <style>
    .focus-ring:focus { outline:2px solid #35C6E0; outline-offset:3px; }
    .text-gradient{
      background: linear-gradient(90deg, #CFE5EF 0%, #35C6E0 60%, #7C4DFF 100%);
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    .soft-card{
      border: 1px solid rgba(20,53,69,.65);
      background: rgba(15,34,48,.35);
      border-radius: 1rem;
      box-shadow: 0 6px 18px rgba(0,0,0,.12);
      backdrop-filter: blur(6px);
    }
    .tag{
      border: 1px solid rgba(20,53,69,.65);
      background: rgba(10,20,27,.25);
      border-radius: 9999px;
      padding: .25rem .75rem;
      font-size: .75rem;
      color: rgba(207,229,239,.85);
      white-space: nowrap;
    }
    .meta-pill{
      border: 1px solid rgba(20,53,69,.65);
      background: rgba(10,20,27,.25);
      border-radius: .9rem;
      padding: .65rem .9rem;
      min-width: 0;            /* allow it to shrink */
      max-width: 100%;
    }
    @media (min-width: 640px) { /* sm and up */
      .meta-pill{ min-width: 200px; }
    }

  </style>
</head>

<body class="bg-deep-space text-stardust font-body selection:bg-glow/20 selection:text-stardust">
  <main class="relative min-h-screen">
    <!-- Background -->
    <img src="/images/background-1.png" alt="" class="absolute inset-0 h-full w-full object-cover" />
    <div class="absolute inset-0 bg-gradient-to-br from-deep-space/70 via-abyss/80 to-deep-space/85"></div>

    <!-- Top Nav -->
    <div id="site-header"></div>

    <!-- Hero -->
    <section class="relative mx-auto max-w-6xl px-6 pt-10 pb-6">
      <p class="uppercase tracking-[.18em] text-stardust/70 text-xs">
        Dreaming Tower Archives
      </p>
      <h1 class="mt-2 font-display text-4xl sm:text-5xl leading-tight text-gradient">
        Chronicles
      </h1>
      <p class="mt-4 max-w-3xl text-stardust/85">
        Recovered tales from the Digital Realm, recorded by the Lorekeeper. Open a chronicle to read the story,
        then flip the page to reveal its real-world meaning.
      </p>

      <!-- Utility row -->
      <div class="mt-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
        <div class="flex flex-wrap gap-2 text-xs text-stardust/80">
          <span class="rounded-full border border-rift/60 bg-abyss/30 px-3 py-1">Flip-to-Analysis</span>
          <span class="rounded-full border border-rift/60 bg-abyss/30 px-3 py-1">Lore + Lessons</span>
          <span class="rounded-full border border-rift/60 bg-abyss/30 px-3 py-1">New entries incoming</span>
        </div>

        <!-- Placeholder filters (Phase 2) -->
        <div class="text-sm text-stardust/70">
          <span class="inline-flex items-center gap-2 rounded-lg border border-rift/60 bg-abyss/30 px-3 py-2">
            Filters (coming soon)
          </span>
        </div>
      </div>
    </section>

    <!-- Divider -->
    <div class="relative mx-auto max-w-6xl px-6">
      <div class="h-px w-full bg-rift/60"></div>
    </div>

    <!-- Content -->
    <section class="relative mx-auto max-w-6xl px-6 pt-8 pb-14">
      <div class="grid gap-6 lg:grid-cols-3 lg:items-start">

        <!-- Featured Chronicle -->
        <article id="featuredChronicle" class="lg:col-span-2 soft-card p-6 hidden"></article>

        <!-- Sidebar: Subscribe / CTA -->
        <aside class="soft-card p-6 lg:col-start-3 lg:row-span-2 lg:mt-6">
          <h3 class="font-display text-xl text-stardust/95">Receive New Chronicles</h3>
          <p class="mt-2 text-sm text-stardust/80 leading-relaxed">
            Join the Tower’s list and you’ll receive a raven when new tales and excerpts are released.
          </p>

          <div class="mt-5">
            <a href="/#email"
               class="focus-ring inline-flex w-full items-center justify-center rounded-md bg-glow px-5 py-3 font-semibold text-abyss shadow-glow hover:brightness-110">
              Subscribe on Home
            </a>
          </div>

          <p class="mt-3 text-xs text-stardust/65">
            No spam. Just dispatches from the Dreaming Tower.
          </p>

          <div class="mt-6 h-px w-full bg-rift/60"></div>

          <h4 class="mt-6 font-display text-lg text-stardust/95">Coming Soon</h4>
          <ul class="mt-3 space-y-2 text-sm text-stardust/80">
            <li>• Additional recovered Chronicles</li>
            <li>• Journal excerpts from the Lorekeeper</li>
            <li>• Glitchborne field notes</li>
            <li>• World history and records</li>
          </ul>
        </aside>

        <!-- Chronicle List (replaces placeholders) -->
        <section id="allChronicles" class="lg:col-span-2 soft-card p-6">
          <div class="flex flex-col gap-1">
            <h3 class="font-display text-xl text-stardust/95">All Chronicles</h3>
            <p class="text-sm text-stardust/75">Browse recovered entries from the Tower’s archives.</p>
          </div>

          <ul id="chronicleList" class="mt-5 space-y-4"></ul>

          <p class="mt-6 text-xs text-stardust/65">
            More entries will surface as the Tower releases them.
          </p>
        </section>
      </div>

      <!-- Footer -->
      <div id="site-footer"></div>
    </section>
  </main>

  <script>
  const CHRONICLES = [
    {
      enabled: true,
      featured: false,
      type: "Recovered Chronicle",
      title: "The Breach at Merchant’s Gate",
      href: "/chronicles/merchants-gate.html",
      blurb: "Seven entities entered through trusted writs and moved like ink through commerce, records, keys, and vaults. The Kingdom survived, but only by invoking a dangerous Purge Script and accepting loss.",
      tags: ["Theme: Supply Chain", "Threat: Rot Swarm", "Flip: Real-World Analysis"],
      status: "Complete",
      readTime: "~10–12 min"
    }
  ];

  const featuredEl = document.getElementById('featuredChronicle');
  const allListEl = document.getElementById('chronicleList');

  const visible = CHRONICLES.filter(c => c.enabled);
  const featured = visible.find(c => c.featured);

  // Render Featured (only if configured)
  if (featured && featuredEl) {
    featuredEl.classList.remove('hidden');

    featuredEl.innerHTML = `
      <div class="flex flex-col gap-5">
        <div class="flex items-start justify-between gap-6">
          <div class="min-w-0">
            <p class="uppercase tracking-[.18em] text-stardust/70 text-xs">Featured • ${featured.type}</p>
            <h2 class="mt-2 font-display text-2xl sm:text-3xl text-stardust/95">${featured.title}</h2>
            <p class="mt-3 text-stardust/85 leading-relaxed">${featured.blurb}</p>

            <div class="mt-4 flex flex-wrap gap-2">
              ${(featured.tags || []).map(t => `<span class="tag">${t}</span>`).join("")}
            </div>
          </div>

          <div class="hidden sm:grid grid-cols-1 gap-3 max-w-full">
            <div class="meta-pill">
              <p class="text-[11px] uppercase tracking-[.18em] text-stardust/60">Status</p>
              <p class="mt-1 text-sm text-stardust/90">${featured.status || ""}</p>
            </div>
            <div class="meta-pill">
              <p class="text-[11px] uppercase tracking-[.18em] text-stardust/60">Read time</p>
              <p class="mt-1 text-sm text-stardust/90">${featured.readTime || ""}</p>
            </div>
          </div>
        </div>

        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
          <a href="${featured.href}"
             class="focus-ring inline-flex items-center justify-center rounded-md bg-glow px-5 py-3 font-semibold text-abyss shadow-glow hover:brightness-110">
            Open Chronicle →
          </a>

          <a href="/characters/"
             class="inline-flex items-center justify-center rounded-md border border-rift/60 bg-deep-space/20 px-5 py-3 text-sm text-stardust/85 hover:text-glow">
            Meet the characters
          </a>
        </div>
      </div>
    `;
  }

  // Render All Chronicles list
  if (allListEl) {
    allListEl.innerHTML = visible.map(c => `
      <li class="rounded-xl border border-rift/60 bg-deep-space/10 p-5">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
          <div class="min-w-0">
            <p class="uppercase tracking-[.18em] text-stardust/60 text-xs">${c.type}</p>
            <h4 class="mt-2 font-display text-2xl text-stardust/95">
              <a class="hover:text-glow underline underline-offset-4" href="${c.href}">
                ${c.title}
              </a>
            </h4>
            <p class="mt-3 text-sm text-stardust/80 leading-relaxed">${c.blurb || ""}</p>

            <div class="mt-4 flex flex-wrap gap-2">
              ${(c.tags || []).map(t => `<span class="tag">${t}</span>`).join("")}
            </div>
          </div>

          <div class="flex flex-row gap-2 sm:flex-col sm:items-end">
            ${c.status ? `<span class="tag">Status: ${c.status}</span>` : ""}
            ${c.readTime ? `<span class="tag">Read: ${c.readTime}</span>` : ""}
          </div>
        </div>

        <div class="mt-5">
          <a href="${c.href}"
             class="inline-flex items-center text-sm text-stardust/80 hover:text-glow underline underline-offset-4">
            Open chronicle →
          </a>
        </div>
      </li>
    `).join("");
  }

  async function loadPartial(targetId, url) {
    const el = document.getElementById(targetId);
    if (!el) return;

    const res = await fetch(url, { cache: "no-cache" });
    if (!res.ok) {
      console.warn(`Failed to load ${url}`);
      return;
    }
    el.innerHTML = await res.text();
  }

  function initHeaderNav() {
    const navToggle = document.getElementById("navToggle");
    const mobileNavPanel = document.getElementById("mobileNavPanel");

    if (!navToggle || !mobileNavPanel) return;

    navToggle.addEventListener("click", () => {
      const isOpen = navToggle.getAttribute("aria-expanded") === "true";
      navToggle.setAttribute("aria-expanded", String(!isOpen));
      mobileNavPanel.classList.toggle("hidden", isOpen);
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        navToggle.setAttribute("aria-expanded", "false");
        mobileNavPanel.classList.add("hidden");
      }
    });
  }

  function initFooterYear() {
    const year = document.getElementById("year");
    if (year) year.textContent = new Date().getFullYear();
  }

  (async function boot() {
    await loadPartial("site-header", "/partials/header.html");
    initHeaderNav();

    await loadPartial("site-footer", "/partials/footer.html");
    initFooterYear();
  })();
</script>

</body>
</html>
